{
  "id": "RUSTSEC-2019-0014",
  "modified": "2020-10-02T01:29:11+00:00",
  "published": "2019-08-21T12:00:00+00:00",
  "aliases": [
    "CVE-2019-16138"
  ],
  "related": [],
  "package": {
    "ecosystem": "crates.io",
    "name": "image",
    "purl": "pkg:cargo/image"
  },
  "summary": "Flaw in interface may drop uninitialized instance of arbitrary types",
  "details": "Affected versions of this crate would call `Vec::set_len` on an uninitialized\nvector with user-provided type parameter, in an interface of the HDR image\nformat decoder. They would then also call other code that could panic before\ninitializing all instances.\n\nThis could run Drop implementations on uninitialized types, equivalent to\nuse-after-free, and allow an attacker arbitrary code execution.\n\nTwo different fixes were applied. It is possible to conserve the interface by\nensuring proper initialization before calling `Vec::set_len`. Drop is no longer\ncalled in case of panic, though.\n\nStarting from version `0.22`, a breaking change to the interface requires\ncallers to pre-allocate the output buffer and pass a mutable slice instead,\navoiding all unsafe code.",
  "affects": {
    "ranges": [
      {
        "type": "SEMVER",
        "introduced": "0.10.2",
        "fixed": "0.21.3"
      }
    ]
  },
  "references": [
    {
      "type": "PACKAGE",
      "url": "https://crates.io/crates/image"
    },
    {
      "type": "ADVISORY",
      "url": "https://rustsec.org/advisories/RUSTSEC-2019-0014.html"
    },
    {
      "type": "WEB",
      "url": "https://github.com/image-rs/image/pull/985"
    }
  ],
  "ecosystem_specific": {
    "affects": {
      "arch": [],
      "os": [],
      "functions": [
        "image::hdr::HDRDecoder::read_image_transform"
      ]
    }
  },
  "database_specific": {
    "categories": [],
    "cvss": null,
    "informational": null
  }
}